<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../stylesheets/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.css"
    integrity="sha512-6S2HWzVFxruDlZxI3sXOZZ4/eJ8AcxkQH1+JjSe/ONCEqR9L4Ysq5JdT5ipqtzU7WHalNwzwBv+iE51gNHJNqQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="../stylesheets/dashboard.css">
  <title>Dashboard</title>
  <link rel="icon" href="../images/dashboard.png">
</head>

<body>
  <header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Quizee</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01"
          aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarColor01">
          <ul class="navbar-nav me-auto">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button"
                  role="tab" aria-controls="home" aria-selected="true">Author</button>
              </li>&nbsp;
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button"
                  role="tab" aria-controls="profile" aria-selected="false">Participate</button>
              </li>&nbsp;
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="leaderboard-tab" data-bs-toggle="tab" data-bs-target="#leaderboard"
                  type="button" role="tab" aria-controls="profile" aria-selected="false">Leaderboards</button>
              </li>&nbsp;
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="myquizzes-tab" data-bs-toggle="tab" data-bs-target="#Myquizzes"
                  type="button" role="tab" aria-controls="profile" aria-selected="false">My Quizzes</button>
              </li>
            </ul>
          </ul>
          <div class="d-flex">
            <button class="btn btn-secondary my-2 my-sm-0 " id="Logoutbtn" type="submit">Logout</button>
          </div>
        </div>
      </div>
    </nav>
  </header>



  <main>

    <!-- Author Tab -->
    <div class="tab-content" id="myTabContent"
      style="padding-left: 5%; padding-right: 5%;padding-top: 15vh; padding-bottom:5%">
      <div class="tab-pane fade show active" style="padding-top: 0%;margin-top: 0%;" id="home" role="tabpanel"
        aria-labelledby="home-tab">
        <button id="createquiz" type="button" class="btn btn-success">Create Quiz</button>
        <div id="created" style="display: none;">
          <div>
            <div>
              <h3>Wollah! Your quiz has been created Sucessfully</h3>
            </div>
            <div>
              <h4 id="quizcreatedid"></h4>
            </div>
          </div>
          <div><img src="../images/created.svg" width="50%"></div>
        </div>

        <div class="p-4"><button type="button" class="btn btn-primary" id="quizid-okbutton"
            style="display: none;">Okay</button>
        </div>
        <form id="quizform" style="padding-left: 3vw; padding-right: 3vw; background-color: aliceblue ;display: none;"
          class="shadow rounded">
          <div id="forminner">
          </div>
          <div id="terminals" style="padding-bottom:3vw;display: none;">
            <button type="button" class="btn btn-success" id="addquestion">Add Question</button>&nbsp;
            <button type="button" class="btn btn-danger" id="deletequestion">Remove Question</button>&nbsp;
            <button type="button" class="btn btn-danger" id="clearquiz">Clear Quiz</button>&nbsp;
            <button type="button" class="btn btn-primary" id="submitquestion">Submit</button>
          </div>
        </form>
      </div>


      <!-- Participate Tab -->
      <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
        <div class="form-group d-flex" id="q-name">
          <input type="text" class="form-control" id="quizid" aria-describedby="emailHelp"
            placeholder="Enter Quiz Code">&nbsp;
          <button id="participatequiz" type="button" class="btn btn-success">Participate</button>
        </div>



        <div id="marks_declaration" style="display: none;">
          <span>
            <h1 style="display:inline;">Your Score: </h1>
            <h1 style="display:inline;" id="marks"></h1>
          </span>
        </div>

        <div>
          <br><button type="button" class="btn btn-primary" id="marksokbutton" style="display: none;">Ok</button>
        </div>
        <br>
        <div>
          <h2 id="quiztitle"></h2>
        </div><br>
        <div id="quizsubmitform" style="display: none;">

        </div><br><br>

        <button type="button" class="btn btn-primary" id="submitquizbutton"
          style="display: none;margin-left: 8%;">Submit</button>
      </div>



      <!-- Leaderboard Tab -->
      <div class="tab-pane fade" id="leaderboard" role="tabpanel" aria-labelledby="leaderboard-tab">
        <h2 id="quizheading">Quizzes Participated</h2><br>
        <div style="display: none;" id="quizparticipatedlist" class="section group">

        </div>
        <h2 style="display: none;" id="leaderboardheading">Leaderboard</h2>
        <table class="table table-hover" id="lb-table" style="display: none;">
          <thead>
            <tr>
              <th scope="col">Score</th>
              <th scope="col">Email</th>
              <th scope="col">First Name</th>
              <th scope="col">Last Name</th>
            </tr>
          </thead>
          <tbody id="lb-table-body">

          </tbody>
        </table><br><br>
        <button type="button" class="btn btn-primary" id="lb-okbutton" style="display: none;">Back</button>

      </div>

      <!-- My Quizzes Tab -->

      <div class="tab-pane fade" id="Myquizzes" role="tabpanel" aria-labelledby="myquizzes-tab">

        <h2 id="myquiz-heading">Welcome to your Quizzes</h2>

        <div style="display: none;" id="myquizzes-list" class="section group">

        </div>

        <form id="update-quizform" style="display: none; background-color: lightblue;">
          <div id="update-forminner">
          </div><br>
          <div id="upd-terminals" class="d-flex justify-content-between" style="padding-bottom:3vw;display: none;">
            <button type="button" class="btn btn-success" id="upd-addquestion">Add Question</button>
            <button type="button" class="btn btn-danger" id="upd-deletequestion">Remove Question</button>
            <button type="button" class="btn btn-info" id="upd-clearquiz">Back</button>
            <button type="button" class="btn btn-primary" id="upd-submitquestion">Update</button>
          </div>
        </form>
      </div>
    </div>

  </main>
  <footer>

  </footer>

  <script>
    function myFunction( event ) {
      var x = event.target;
      console.log( x.id );
      var reqid = x.id;
      $.ajax( {
        method: 'GET',
        url: `/dashboard/api/quiz/leaderboard/${reqid}`,
        success: function ( data ) {
          if ( data.success ) {
            var lb_array = data.leaderboard;
            lb_array.sort( function ( a, b ) {
              return b.marks - a.marks;
            } );
            console.log( lb_array );
            for ( var lb = 0; lb < lb_array.length; lb++ ) {
              //var lb_e=lb+1;

              var lb_record = document.createElement( 'tr' );
              lb_record.innerHTML = ` <th scope="row">${lb_array[lb].marks}</th>
                                                        <td>${lb_array[lb].email}</td>
                                                        <td>${lb_array[lb].firstname}</td>
                                                        <td>${lb_array[lb].lastname}</td>`
              document.getElementById( 'lb-table-body' ).appendChild( lb_record );
            }

            $( "#quizheading" ).hide();
            $( "#quizparticipatedlist" ).hide();
            $( "#leaderboardheading" ).show();
            $( "#lb-table" ).show();
            $( "#lb-okbutton" ).show();
          }
          else {
            toastr.error( err );
          }
        }

      } );
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js"
    integrity="sha512-lbwH47l/tPXJYG9AcFNoJaTMhGvYWhVM9YI43CT+uteTRRaiLCui8snIgyAN8XWgNjNhCqlAUdzZptso6OCoFQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="module" src="../javascripts/dashboard.js  "></script>
</body>

</html>
